@if (totalCount === 0) {
  <div>
    <div class="mb-3">
      @if (!loading) {
        <p>{{ 'person-search.result' | translate }} {{ 'person-search.no-results' | translate }}</p>
      } @else {
        @if (loading) {
          <app-labeled-spinner></app-labeled-spinner>
        }
      }
    </div>
  </div>
}
<div [hidden]="totalCount === 0">
  <div>
    @if (loading) {
      <app-labeled-spinner class="mb-2"></app-labeled-spinner>
    } @else {
      <p>{{ 'person-search.result' | translate }}{{ totalCount | number }}</p>
      @if (invalidCount > 0) {
        <p class="italic">
          <bc-icon class="color-warning" icon="exclamation-triangle-o"></bc-icon>
          {{ 'person-search.invalid-count' | translate: { count: invalidCount | number } }}
        </p>
      }
    }
  </div>
  <app-fixed-space-loading-bar [loading]="loading"></app-fixed-space-loading-bar>
  @if (totalCount !== 0) {
    <bc-table [dataSource]="datasource" [fixed]="false">
      <ng-container [columnDef]="columns.actuality">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.actuality | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          @if (person[columns.actuality]) {
            <bc-icon
              [icon]="'checkmark'"
              class="actuality__true"
              [title]="('person.actuality' | translate) + (person.actualityDate | localDate: true)"
            >
            </bc-icon>
          } @else {
            <bc-icon
              [icon]="'exclamation-circle-o'"
              class="actuality__false"
              [title]="('person.actuality' | translate) + (person.actualityDate | localDate: true)"
            ></bc-icon>
          }
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.officialName">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.officialName | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.officialName }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.firstName">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.firstName | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.firstName }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.dateOfBirth">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.dateOfBirth | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.dateOfBirth | localDate }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.street">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.street | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.contactAddressStreet }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.houseNumber">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.houseNumber | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.contactAddressHouseNumber }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.zipCode">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.zipCode | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.contactAddressZipCode }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.town">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.town | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.contactAddressTown }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.countryNameShort">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.countryNameShort | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.countryNameShort ? person.countryNameShort : person.country }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.locality">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.locality | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          @if (!person.isSwissAbroad) {
            <span
              >{{ person.contactAddressLocality || person.municipalityName }} ({{
                person.municipalityId
              }})</span
            >
          } @else {
            <span>{{ person.municipalityName }} ({{ person.municipalityId }})</span>
          }
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.residence">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.residence | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ person.typeOfResidence }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.source">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.source | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          {{ 'data-overview.source-system.' + person.sourceSystemName | translate }}
        </bc-data-cell>
      </ng-container>
      <ng-container [columnDef]="columns.isVotingAllowed">
        <bc-header-cell *headerCellDef>{{
          'person-table.columns.' + columns.isVotingAllowed | translate
        }}</bc-header-cell>
        <bc-data-cell *dataCellDef="let person">
          @if (person.isVotingAllowed) {
            <bc-status-label
              [backgroundColor]="'#e8f4ed'"
              [width]="'60px'"
              [label]="'person-table.votingRight.yes' | translate"
            ></bc-status-label>
          }
          @if (!person.isVotingAllowed) {
            <bc-status-label
              [backgroundColor]="'#c60000'"
              [foregroundColor]="'light'"
              [width]="'60px'"
              [label]="'person-table.votingRight.no' | translate"
            ></bc-status-label>
          }
        </bc-data-cell>
      </ng-container>
      <bc-header-row *headerRowDef="let row; columns: columnsToDisplay"></bc-header-row>
      <bc-data-row
        *dataRowDef="let row; columns: columnsToDisplay"
        class="pointer"
        (click)="openDetailView(row.registerId)"
      ></bc-data-row>
    </bc-table>
  }
  <bc-paginator
    showFirstLastButtons
    (page)="selectPage($event)"
    [length]="totalCount"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[5, 10, 20, 50, 100]"
  >
  </bc-paginator>
</div>
<bc-divider></bc-divider>
